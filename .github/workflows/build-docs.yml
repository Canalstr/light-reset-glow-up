name: build-and-commit-docs
on: [push]

jobs:
  build:
    runs-on: ubuntu-latest
    permissions:
      contents: write           # allows the Action to push
    steps:
      - uses: actions/checkout@v4

      # Install Node & deps
      - uses: actions/setup-node@v4
        with:
          node-version: 20

      - run: npm ci

      # Build Vite output into docs/
      - run: npm run build

      # Drop a .nojekyll file to stop Jekyll stripping folders that start with '_'
      - run: echo "" > docs/.nojekyll

      # Commit the docs/ folder back to main
      - name: Commit docs
        uses: EndBug/add-and-commit@v9
        with:
          add: docs
          message: "docs: auto-generated build [skip ci]"
          default_author: github_actions
